<%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8"%>
<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c" %>
<%@ page session="false" %>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>


<!-- -------------------------------------------------------------------------------------------------------------- -->


<head>
	<meta http-equiv="content-type" content="text/html; charset=UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">
</head>


<!-- -------------------------------------------------------------------------------------------------------------- -->


<html>
	
	<body>
	
		<br/> 상세 페이지 <br/><br/>
		<button> <a onclick="href='/'"> 전체 목록 </a> </button>

		<br/><br/>
		
		<table id="boardDetailTitle" border="1" width="480">
		
			<th style="width:25%"> 구분 </th>
			<th style="width:75%"> 상세 </th>

			<tbody id="boardDetail">
				<tr>
					<td> idx </td>
					<td> idx </td>
				</tr>
				<tr>
					<td> title </td>
					<td> title </td>
				</tr>
				<tr>
					<td> content </td>
					<td> content </td>
				</tr>
				<tr>
					<td> writer </td>
					<td> writer </td>
				</tr>
				<tr>
					<td> regdate </td>
					<td> regdate </td>
				</tr>
			</tbody>

		</table>
		
		<br/><br/>
		<button> <a onclick="href='modifypage?idx=2'"> 게시글 수정하기 </a> </button>
		
	</body>

	
<!-- -------------------------------------------------------------------------------------------------------------- -->

	
	<script type="text/javascript">
	
		// 최초 로딩 시, 게시글 출력.
		var idx = getParam("idx");
		console.log(idx);
		boardDetailRefresh(idx);


<!-- -------------------------------------------------------------------------------------------------------------- -->

	// 게시글 목록 출력/갱신.
	function boardDetailRefresh(_idx) {

		$.ajax({
					type: "GET",
					url: "http://localhost:8080/api/getboarddetail",
					cache: false,
					async: false,
					data: {
						idx : _idx
					},
					success: function (result) {
                        boardDetailData = result;
					}
				
		});
		
		console.log(boardDetailData);
		
		$("#boardDetail").empty();
		
		var html = $("#boardDetail").html();
		
		$.each(boardDetailData, function(index, item){
		
			html += "<tr>"
					+ "<td> <input type='checkbox' name='tdCheck' data-idx='" + item.idx + "' value='" + item.idx + "' /> </td>"
					+ "<td>" + item.idx + "</td>"
					+ "<td>" + item.title + "</td>"
					+ "<td> <a href='./detailpage?idx=" + item.idx + "';'>" + item.content + "</td>"
					+ "<td>" + item.writer + "</td>"
					+ "<td>" + item.regdate.replace('T',' ').substring(0, 19) + "</td>"
					+ "<td> <button onclick=" + "location.href='./modifypage?idx=" + item.idx + "';>" + "바로가기 </button> </td>"
					+ "</tr>";
		})
		
		$("#boardList").html(html);
		
	}


<!-- -------------------------------------------------------------------------------------------------------------- -->


	function getParam(sname) {
	    var params = location.search.substr(location.search.indexOf("?") + 1);
	    params = params.split("&");
	    //console.log(params);
	    
	    var sval = "";
	
	    for (var i = 0; i < params.length; i++) {
	        temp = params[i].split("=");
	        //console.log(temp);
	        if ([temp[0]] == sname) { sval = temp[1]; }
	    }
	
	    return sval;

	}
	

<!-- -------------------------------------------------------------------------------------------------------------- -->

		
	</script>

</html>